'''
Instructions
- Get a fraction of the training data determined by the size we are currently evaluating in the loop.
- Set the model weights to the initial_weights with set_weights() and train your model on the fraction of training data using early_stop as a callback.
- Evaluate and store the accuracy for the training fraction and the test set.
- Call plot_results() passing in the training and test accuracies for each training size.
'''

for size in training_sizes:
  	# Get a fraction of training data (we only care about the training data)
    X_train_frac, y_train_frac = X_train[:size], y_train[:size]

    # Reset the model to the initial weights and train it on the new data fraction
    model.set_weights(initial_weights)
    model.fit(X_train_frac, y_train_frac, epochs = 50, callbacks = [early_stop])

    # Evaluate and store the train fraction and the complete test set results
    train_accs.append(model.evaluate(X_train_frac, y_train_frac)[1])
    test_accs.append(model.evaluate(X_test, y_test)[1])
    
# Plot train vs test accuracies
plot_results(train_accs, test_accs)

'''
Output;

Epoch 1/50

 32/125 [======>.......................] - ETA: 0s - loss: 12.5863 - acc: 0.1250
125/125 [==============================] - 0s 1ms/step - loss: 11.6090 - acc: 0.1440
Epoch 2/50

 32/125 [======>.......................] - ETA: 0s - loss: 13.0683 - acc: 0.1250
125/125 [==============================] - 0s 52us/step - loss: 10.7593 - acc: 0.1200
Epoch 3/50

 32/125 [======>.......................] - ETA: 0s - loss: 9.7035 - acc: 0.1875
125/125 [==============================] - 0s 51us/step - loss: 9.9004 - acc: 0.1040
Epoch 4/50

 32/125 [======>.......................] - ETA: 0s - loss: 8.5511 - acc: 0.0312
125/125 [==============================] - 0s 54us/step - loss: 8.8984 - acc: 0.1120
Epoch 5/50

 32/125 [======>.......................] - ETA: 0s - loss: 8.8890 - acc: 0.1875
125/125 [==============================] - 0s 51us/step - loss: 7.6858 - acc: 0.1280
Epoch 6/50

 32/125 [======>.......................] - ETA: 0s - loss: 5.5018 - acc: 0.1562
125/125 [==============================] - 0s 51us/step - loss: 6.7714 - acc: 0.1120
Epoch 7/50

 32/125 [======>.......................] - ETA: 0s - loss: 7.0177 - acc: 0.0938
125/125 [==============================] - 0s 51us/step - loss: 6.0643 - acc: 0.1360
Epoch 8/50

 32/125 [======>.......................] - ETA: 0s - loss: 6.9508 - acc: 0.1562
125/125 [==============================] - 0s 50us/step - loss: 5.5670 - acc: 0.1760
Epoch 9/50

 32/125 [======>.......................] - ETA: 0s - loss: 4.0410 - acc: 0.1875
125/125 [==============================] - 0s 50us/step - loss: 5.1579 - acc: 0.2000
Epoch 10/50

 32/125 [======>.......................] - ETA: 0s - loss: 4.2861 - acc: 0.3438
125/125 [==============================] - 0s 51us/step - loss: 4.7761 - acc: 0.2480
Epoch 11/50

 32/125 [======>.......................] - ETA: 0s - loss: 3.4075 - acc: 0.4062
125/125 [==============================] - 0s 50us/step - loss: 4.4088 - acc: 0.2400
Epoch 12/50

 32/125 [======>.......................] - ETA: 0s - loss: 4.5478 - acc: 0.2812
125/125 [==============================] - 0s 51us/step - loss: 4.0802 - acc: 0.2960
Epoch 13/50

 32/125 [======>.......................] - ETA: 0s - loss: 4.1811 - acc: 0.3750
125/125 [==============================] - 0s 51us/step - loss: 3.7558 - acc: 0.3120
Epoch 14/50

 32/125 [======>.......................] - ETA: 0s - loss: 3.9077 - acc: 0.2812
125/125 [==============================] - 0s 52us/step - loss: 3.4738 - acc: 0.3440
Epoch 15/50

 32/125 [======>.......................] - ETA: 0s - loss: 2.9751 - acc: 0.2500
125/125 [==============================] - 0s 50us/step - loss: 3.1660 - acc: 0.3600
Epoch 16/50

 32/125 [======>.......................] - ETA: 0s - loss: 2.7039 - acc: 0.3125
125/125 [==============================] - 0s 50us/step - loss: 2.9069 - acc: 0.4080
Epoch 17/50

 32/125 [======>.......................] - ETA: 0s - loss: 3.0277 - acc: 0.4062
125/125 [==============================] - 0s 51us/step - loss: 2.6787 - acc: 0.4160
Epoch 18/50

 32/125 [======>.......................] - ETA: 0s - loss: 1.5606 - acc: 0.5312
125/125 [==============================] - 0s 50us/step - loss: 2.4551 - acc: 0.4080
Epoch 19/50

 32/125 [======>.......................] - ETA: 0s - loss: 1.9014 - acc: 0.4375
125/125 [==============================] - 0s 51us/step - loss: 2.2469 - acc: 0.4240
Epoch 20/50

 32/125 [======>.......................] - ETA: 0s - loss: 2.2111 - acc: 0.4375
125/125 [==============================] - 0s 52us/step - loss: 2.0854 - acc: 0.4480
Epoch 21/50

 32/125 [======>.......................] - ETA: 0s - loss: 1.8431 - acc: 0.5625
125/125 [==============================] - 0s 51us/step - loss: 1.9417 - acc: 0.4960
Epoch 22/50

 32/125 [======>.......................] - ETA: 0s - loss: 1.6094 - acc: 0.4688
125/125 [==============================] - 0s 50us/step - loss: 1.8103 - acc: 0.5120
Epoch 23/50

 32/125 [======>.......................] - ETA: 0s - loss: 1.4166 - acc: 0.6562
125/125 [==============================] - 0s 51us/step - loss: 1.7151 - acc: 0.5200
Epoch 24/50

 32/125 [======>.......................] - ETA: 0s - loss: 1.6233 - acc: 0.5312
125/125 [==============================] - 0s 51us/step - loss: 1.6233 - acc: 0.5520
Epoch 25/50

 32/125 [======>.......................] - ETA: 0s - loss: 2.0595 - acc: 0.4062
125/125 [==============================] - 0s 50us/step - loss: 1.5544 - acc: 0.5680
Epoch 26/50

 32/125 [======>.......................] - ETA: 0s - loss: 1.5321 - acc: 0.6562
125/125 [==============================] - 0s 51us/step - loss: 1.4875 - acc: 0.5840
Epoch 27/50

 32/125 [======>.......................] - ETA: 0s - loss: 1.4614 - acc: 0.4688
125/125 [==============================] - 0s 51us/step - loss: 1.4341 - acc: 0.5840
Epoch 28/50

 32/125 [======>.......................] - ETA: 0s - loss: 1.4266 - acc: 0.5938
125/125 [==============================] - 0s 51us/step - loss: 1.3826 - acc: 0.6000
Epoch 29/50

 32/125 [======>.......................] - ETA: 0s - loss: 1.0867 - acc: 0.7500
125/125 [==============================] - 0s 52us/step - loss: 1.3316 - acc: 0.6320
Epoch 30/50

 32/125 [======>.......................] - ETA: 0s - loss: 1.1888 - acc: 0.7188
125/125 [==============================] - 0s 50us/step - loss: 1.2918 - acc: 0.6400
Epoch 31/50

 32/125 [======>.......................] - ETA: 0s - loss: 1.1037 - acc: 0.6875
125/125 [==============================] - 0s 51us/step - loss: 1.2473 - acc: 0.6480
Epoch 32/50

 32/125 [======>.......................] - ETA: 0s - loss: 1.1985 - acc: 0.6562
125/125 [==============================] - 0s 52us/step - loss: 1.2049 - acc: 0.6480
Epoch 33/50

 32/125 [======>.......................] - ETA: 0s - loss: 0.7581 - acc: 0.8125
125/125 [==============================] - 0s 50us/step - loss: 1.1672 - acc: 0.6560
Epoch 34/50

 32/125 [======>.......................] - ETA: 0s - loss: 1.0535 - acc: 0.6875
125/125 [==============================] - 0s 51us/step - loss: 1.1274 - acc: 0.6560
Epoch 35/50

 32/125 [======>.......................] - ETA: 0s - loss: 1.0482 - acc: 0.6250
125/125 [==============================] - 0s 51us/step - loss: 1.0930 - acc: 0.6480
Epoch 36/50

 32/125 [======>.......................] - ETA: 0s - loss: 1.2698 - acc: 0.6250
125/125 [==============================] - 0s 50us/step - loss: 1.0597 - acc: 0.6560
Epoch 37/50

 32/125 [======>.......................] - ETA: 0s - loss: 0.9245 - acc: 0.6875
125/125 [==============================] - 0s 50us/step - loss: 1.0255 - acc: 0.6640
Epoch 38/50

 32/125 [======>.......................] - ETA: 0s - loss: 0.8738 - acc: 0.7500
125/125 [==============================] - 0s 51us/step - loss: 0.9945 - acc: 0.6800
Epoch 39/50

 32/125 [======>.......................] - ETA: 0s - loss: 1.1758 - acc: 0.6562
125/125 [==============================] - 0s 50us/step - loss: 0.9639 - acc: 0.6960
Epoch 40/50

 32/125 [======>.......................] - ETA: 0s - loss: 0.7668 - acc: 0.8125
125/125 [==============================] - 0s 51us/step - loss: 0.9364 - acc: 0.6960
Epoch 41/50

 32/125 [======>.......................] - ETA: 0s - loss: 0.9375 - acc: 0.7500
125/125 [==============================] - 0s 51us/step - loss: 0.9073 - acc: 0.6960
Epoch 42/50

 32/125 [======>.......................] - ETA: 0s - loss: 1.3970 - acc: 0.5312
125/125 [==============================] - 0s 50us/step - loss: 0.8824 - acc: 0.6960
Epoch 43/50

 32/125 [======>.......................] - ETA: 0s - loss: 0.7200 - acc: 0.7500
125/125 [==============================] - 0s 49us/step - loss: 0.8565 - acc: 0.7120
Epoch 44/50

 32/125 [======>.......................] - ETA: 0s - loss: 0.8586 - acc: 0.6875
125/125 [==============================] - 0s 50us/step - loss: 0.8335 - acc: 0.7120
Epoch 45/50

 32/125 [======>.......................] - ETA: 0s - loss: 0.6139 - acc: 0.8125
125/125 [==============================] - 0s 51us/step - loss: 0.8080 - acc: 0.7120
Epoch 46/50

 32/125 [======>.......................] - ETA: 0s - loss: 0.4960 - acc: 0.8750
125/125 [==============================] - 0s 50us/step - loss: 0.7845 - acc: 0.7200
Epoch 47/50

 32/125 [======>.......................] - ETA: 0s - loss: 0.6444 - acc: 0.8125
125/125 [==============================] - 0s 51us/step - loss: 0.7597 - acc: 0.7200
Epoch 48/50

 32/125 [======>.......................] - ETA: 0s - loss: 0.7468 - acc: 0.7500
125/125 [==============================] - 0s 51us/step - loss: 0.7369 - acc: 0.7440
Epoch 49/50

 32/125 [======>.......................] - ETA: 0s - loss: 0.9139 - acc: 0.6562
125/125 [==============================] - 0s 51us/step - loss: 0.7126 - acc: 0.7440
Epoch 50/50

 32/125 [======>.......................] - ETA: 0s - loss: 0.8330 - acc: 0.6875
125/125 [==============================] - 0s 50us/step - loss: 0.6909 - acc: 0.7600

 32/125 [======>.......................] - ETA: 0s
125/125 [==============================] - 0s 165us/step

 32/540 [>.............................] - ETA: 0s
540/540 [==============================] - 0s 19us/step
Epoch 1/50

 32/502 [>.............................] - ETA: 0s - loss: 13.4722 - acc: 0.0312
502/502 [==============================] - 0s 49us/step - loss: 10.3773 - acc: 0.1036
Epoch 2/50

 32/502 [>.............................] - ETA: 0s - loss: 8.1275 - acc: 0.0938
502/502 [==============================] - 0s 50us/step - loss: 6.2492 - acc: 0.2012
Epoch 3/50

 32/502 [>.............................] - ETA: 0s - loss: 5.9942 - acc: 0.1562
502/502 [==============================] - 0s 49us/step - loss: 4.5675 - acc: 0.2948
Epoch 4/50

 32/502 [>.............................] - ETA: 0s - loss: 3.3529 - acc: 0.3438
502/502 [==============================] - 0s 49us/step - loss: 3.2363 - acc: 0.4044
Epoch 5/50

 32/502 [>.............................] - ETA: 0s - loss: 3.3565 - acc: 0.4688
502/502 [==============================] - 0s 49us/step - loss: 2.2275 - acc: 0.4562
Epoch 6/50

 32/502 [>.............................] - ETA: 0s - loss: 1.9971 - acc: 0.4062
502/502 [==============================] - 0s 50us/step - loss: 1.5869 - acc: 0.5120
Epoch 7/50

 32/502 [>.............................] - ETA: 0s - loss: 1.3570 - acc: 0.5312
502/502 [==============================] - 0s 49us/step - loss: 1.2865 - acc: 0.6016
Epoch 8/50

 32/502 [>.............................] - ETA: 0s - loss: 0.8575 - acc: 0.7500
502/502 [==============================] - 0s 50us/step - loss: 1.0921 - acc: 0.6394
Epoch 9/50

 32/502 [>.............................] - ETA: 0s - loss: 1.0239 - acc: 0.5938
502/502 [==============================] - 0s 49us/step - loss: 0.9449 - acc: 0.7032
Epoch 10/50

 32/502 [>.............................] - ETA: 0s - loss: 0.9804 - acc: 0.6562
502/502 [==============================] - 0s 50us/step - loss: 0.8409 - acc: 0.7390
Epoch 11/50

 32/502 [>.............................] - ETA: 0s - loss: 0.6258 - acc: 0.9062
502/502 [==============================] - 0s 50us/step - loss: 0.7649 - acc: 0.7769
Epoch 12/50

 32/502 [>.............................] - ETA: 0s - loss: 0.8950 - acc: 0.7500
502/502 [==============================] - 0s 50us/step - loss: 0.7056 - acc: 0.7888
Epoch 13/50

 32/502 [>.............................] - ETA: 0s - loss: 0.7074 - acc: 0.7500
502/502 [==============================] - 0s 50us/step - loss: 0.6529 - acc: 0.7928
Epoch 14/50

 32/502 [>.............................] - ETA: 0s - loss: 0.5469 - acc: 0.8125
502/502 [==============================] - 0s 50us/step - loss: 0.6066 - acc: 0.8048
Epoch 15/50

 32/502 [>.............................] - ETA: 0s - loss: 0.5476 - acc: 0.7812
502/502 [==============================] - 0s 49us/step - loss: 0.5735 - acc: 0.8127
Epoch 16/50

 32/502 [>.............................] - ETA: 0s - loss: 0.5508 - acc: 0.8125
502/502 [==============================] - 0s 49us/step - loss: 0.5349 - acc: 0.8247
Epoch 17/50

 32/502 [>.............................] - ETA: 0s - loss: 0.3873 - acc: 0.8750
502/502 [==============================] - 0s 50us/step - loss: 0.5054 - acc: 0.8327
Epoch 18/50

 32/502 [>.............................] - ETA: 0s - loss: 0.3515 - acc: 0.9062
502/502 [==============================] - 0s 50us/step - loss: 0.4758 - acc: 0.8466
Epoch 19/50

 32/502 [>.............................] - ETA: 0s - loss: 0.6030 - acc: 0.7188
502/502 [==============================] - 0s 50us/step - loss: 0.4488 - acc: 0.8586
Epoch 20/50

 32/502 [>.............................] - ETA: 0s - loss: 0.3280 - acc: 0.8438
502/502 [==============================] - 0s 49us/step - loss: 0.4190 - acc: 0.8625
Epoch 21/50

 32/502 [>.............................] - ETA: 0s - loss: 0.4128 - acc: 0.8750
502/502 [==============================] - 0s 50us/step - loss: 0.3930 - acc: 0.8685
Epoch 22/50

 32/502 [>.............................] - ETA: 0s - loss: 0.3191 - acc: 0.9375
502/502 [==============================] - 0s 49us/step - loss: 0.3736 - acc: 0.8825
Epoch 23/50

 32/502 [>.............................] - ETA: 0s - loss: 0.3393 - acc: 0.8750
502/502 [==============================] - 0s 49us/step - loss: 0.3507 - acc: 0.8825
Epoch 24/50

 32/502 [>.............................] - ETA: 0s - loss: 0.3457 - acc: 0.9062
502/502 [==============================] - 0s 49us/step - loss: 0.3317 - acc: 0.8964
Epoch 25/50

 32/502 [>.............................] - ETA: 0s - loss: 0.3100 - acc: 0.8438
502/502 [==============================] - 0s 51us/step - loss: 0.3106 - acc: 0.8964
Epoch 26/50

 32/502 [>.............................] - ETA: 0s - loss: 0.1234 - acc: 0.9688
502/502 [==============================] - 0s 50us/step - loss: 0.2945 - acc: 0.9044
Epoch 27/50

 32/502 [>.............................] - ETA: 0s - loss: 0.2968 - acc: 0.8750
502/502 [==============================] - 0s 49us/step - loss: 0.2783 - acc: 0.9104
Epoch 28/50

 32/502 [>.............................] - ETA: 0s - loss: 0.2870 - acc: 0.9062
502/502 [==============================] - 0s 50us/step - loss: 0.2602 - acc: 0.9104
Epoch 29/50

 32/502 [>.............................] - ETA: 0s - loss: 0.3942 - acc: 0.8750
502/502 [==============================] - 0s 49us/step - loss: 0.2487 - acc: 0.9203
Epoch 30/50

 32/502 [>.............................] - ETA: 0s - loss: 0.3014 - acc: 0.9062
502/502 [==============================] - 0s 49us/step - loss: 0.2369 - acc: 0.9283
Epoch 31/50

 32/502 [>.............................] - ETA: 0s - loss: 0.1288 - acc: 1.0000
502/502 [==============================] - 0s 49us/step - loss: 0.2218 - acc: 0.9363
Epoch 32/50

 32/502 [>.............................] - ETA: 0s - loss: 0.2118 - acc: 0.9375
502/502 [==============================] - 0s 50us/step - loss: 0.2104 - acc: 0.9422
Epoch 33/50

 32/502 [>.............................] - ETA: 0s - loss: 0.1567 - acc: 0.9375
502/502 [==============================] - 0s 49us/step - loss: 0.1996 - acc: 0.9363
Epoch 34/50

 32/502 [>.............................] - ETA: 0s - loss: 0.2424 - acc: 0.9062
502/502 [==============================] - 0s 49us/step - loss: 0.1905 - acc: 0.9442
Epoch 35/50

 32/502 [>.............................] - ETA: 0s - loss: 0.1160 - acc: 1.0000
502/502 [==============================] - 0s 49us/step - loss: 0.1835 - acc: 0.9542
Epoch 36/50

 32/502 [>.............................] - ETA: 0s - loss: 0.1391 - acc: 1.0000
502/502 [==============================] - 0s 49us/step - loss: 0.1732 - acc: 0.9502
Epoch 37/50

 32/502 [>.............................] - ETA: 0s - loss: 0.2393 - acc: 0.9375
502/502 [==============================] - 0s 49us/step - loss: 0.1628 - acc: 0.9641
Epoch 38/50

 32/502 [>.............................] - ETA: 0s - loss: 0.1564 - acc: 0.9375
502/502 [==============================] - 0s 50us/step - loss: 0.1549 - acc: 0.9681
Epoch 39/50

 32/502 [>.............................] - ETA: 0s - loss: 0.1694 - acc: 0.9688
502/502 [==============================] - 0s 50us/step - loss: 0.1510 - acc: 0.9641
Epoch 40/50

 32/502 [>.............................] - ETA: 0s - loss: 0.1352 - acc: 0.9375
502/502 [==============================] - 0s 49us/step - loss: 0.1432 - acc: 0.9721
Epoch 41/50

 32/502 [>.............................] - ETA: 0s - loss: 0.1313 - acc: 1.0000
502/502 [==============================] - 0s 49us/step - loss: 0.1375 - acc: 0.9721
Epoch 42/50

 32/502 [>.............................] - ETA: 0s - loss: 0.1129 - acc: 0.9375
502/502 [==============================] - 0s 50us/step - loss: 0.1296 - acc: 0.9761
Epoch 43/50

 32/502 [>.............................] - ETA: 0s - loss: 0.1361 - acc: 1.0000
502/502 [==============================] - 0s 49us/step - loss: 0.1260 - acc: 0.9741
Epoch 44/50

 32/502 [>.............................] - ETA: 0s - loss: 0.1455 - acc: 0.9375
502/502 [==============================] - 0s 50us/step - loss: 0.1186 - acc: 0.9781
Epoch 45/50

 32/502 [>.............................] - ETA: 0s - loss: 0.1250 - acc: 1.0000
502/502 [==============================] - 0s 49us/step - loss: 0.1169 - acc: 0.9781
Epoch 46/50

 32/502 [>.............................] - ETA: 0s - loss: 0.1540 - acc: 0.9688
502/502 [==============================] - 0s 50us/step - loss: 0.1140 - acc: 0.9761
Epoch 47/50

 32/502 [>.............................] - ETA: 0s - loss: 0.1088 - acc: 0.9688
502/502 [==============================] - 0s 49us/step - loss: 0.1053 - acc: 0.9781
Epoch 48/50

 32/502 [>.............................] - ETA: 0s - loss: 0.1758 - acc: 0.9688
502/502 [==============================] - 0s 51us/step - loss: 0.1025 - acc: 0.9801
Epoch 49/50

 32/502 [>.............................] - ETA: 0s - loss: 0.1750 - acc: 0.9062
502/502 [==============================] - 0s 50us/step - loss: 0.0970 - acc: 0.9841
Epoch 50/50

 32/502 [>.............................] - ETA: 0s - loss: 0.0344 - acc: 1.0000
502/502 [==============================] - 0s 52us/step - loss: 0.0931 - acc: 0.9841

 32/502 [>.............................] - ETA: 0s
502/502 [==============================] - 0s 22us/step

 32/540 [>.............................] - ETA: 0s
540/540 [==============================] - 0s 21us/step
Epoch 1/50

 32/879 [>.............................] - ETA: 0s - loss: 11.5872 - acc: 0.1562
879/879 [==============================] - 0s 52us/step - loss: 8.0117 - acc: 0.1854
Epoch 2/50

 32/879 [>.............................] - ETA: 0s - loss: 6.6298 - acc: 0.2188
879/879 [==============================] - 0s 49us/step - loss: 3.1196 - acc: 0.3413
Epoch 3/50

 32/879 [>.............................] - ETA: 0s - loss: 1.4016 - acc: 0.6250
879/879 [==============================] - 0s 49us/step - loss: 1.6456 - acc: 0.4824
Epoch 4/50

 32/879 [>.............................] - ETA: 0s - loss: 1.3936 - acc: 0.5312
879/879 [==============================] - 0s 49us/step - loss: 1.3234 - acc: 0.5700
Epoch 5/50

 32/879 [>.............................] - ETA: 0s - loss: 0.9639 - acc: 0.6562
879/879 [==============================] - 0s 49us/step - loss: 1.1093 - acc: 0.6394
Epoch 6/50

 32/879 [>.............................] - ETA: 0s - loss: 1.0905 - acc: 0.7500
879/879 [==============================] - 0s 49us/step - loss: 0.9563 - acc: 0.6951
Epoch 7/50

 32/879 [>.............................] - ETA: 0s - loss: 0.9794 - acc: 0.6562
879/879 [==============================] - 0s 49us/step - loss: 0.8401 - acc: 0.7372
Epoch 8/50

 32/879 [>.............................] - ETA: 0s - loss: 1.0390 - acc: 0.7188
879/879 [==============================] - 0s 49us/step - loss: 0.7406 - acc: 0.7759
Epoch 9/50

 32/879 [>.............................] - ETA: 0s - loss: 0.9700 - acc: 0.6562
879/879 [==============================] - 0s 49us/step - loss: 0.6608 - acc: 0.7952
Epoch 10/50

 32/879 [>.............................] - ETA: 0s - loss: 0.4989 - acc: 0.8438
879/879 [==============================] - 0s 49us/step - loss: 0.5881 - acc: 0.8259
Epoch 11/50

 32/879 [>.............................] - ETA: 0s - loss: 0.4203 - acc: 0.9062
879/879 [==============================] - 0s 49us/step - loss: 0.5218 - acc: 0.8373
Epoch 12/50

 32/879 [>.............................] - ETA: 0s - loss: 0.4867 - acc: 0.8750
879/879 [==============================] - 0s 49us/step - loss: 0.4661 - acc: 0.8532
Epoch 13/50

 32/879 [>.............................] - ETA: 0s - loss: 0.2205 - acc: 0.9688
879/879 [==============================] - 0s 61us/step - loss: 0.4177 - acc: 0.8840
Epoch 14/50

 32/879 [>.............................] - ETA: 0s - loss: 0.4768 - acc: 0.8750
832/879 [===========================>..] - ETA: 0s - loss: 0.3836 - acc: 0.8870
879/879 [==============================] - 0s 66us/step - loss: 0.3751 - acc: 0.8885
Epoch 15/50

 32/879 [>.............................] - ETA: 0s - loss: 0.2185 - acc: 0.9375
879/879 [==============================] - 0s 61us/step - loss: 0.3375 - acc: 0.9022
Epoch 16/50

 32/879 [>.............................] - ETA: 0s - loss: 0.4207 - acc: 0.8750
879/879 [==============================] - 0s 61us/step - loss: 0.3087 - acc: 0.9033
Epoch 17/50

 32/879 [>.............................] - ETA: 0s - loss: 0.2800 - acc: 0.9375
879/879 [==============================] - 0s 56us/step - loss: 0.2794 - acc: 0.9158
Epoch 18/50

 32/879 [>.............................] - ETA: 0s - loss: 0.1725 - acc: 0.9688
879/879 [==============================] - 0s 49us/step - loss: 0.2563 - acc: 0.9204
Epoch 19/50

 32/879 [>.............................] - ETA: 0s - loss: 0.2419 - acc: 0.9375
879/879 [==============================] - 0s 49us/step - loss: 0.2348 - acc: 0.9283
Epoch 20/50

 32/879 [>.............................] - ETA: 0s - loss: 0.1115 - acc: 0.9688
879/879 [==============================] - 0s 50us/step - loss: 0.2151 - acc: 0.9340
Epoch 21/50

 32/879 [>.............................] - ETA: 0s - loss: 0.1656 - acc: 1.0000
879/879 [==============================] - 0s 49us/step - loss: 0.1975 - acc: 0.9408
Epoch 22/50

 32/879 [>.............................] - ETA: 0s - loss: 0.2107 - acc: 0.9375
879/879 [==============================] - 0s 50us/step - loss: 0.1844 - acc: 0.9431
Epoch 23/50

 32/879 [>.............................] - ETA: 0s - loss: 0.2239 - acc: 0.9062
879/879 [==============================] - 0s 50us/step - loss: 0.1773 - acc: 0.9499
Epoch 24/50

 32/879 [>.............................] - ETA: 0s - loss: 0.4028 - acc: 0.9062
879/879 [==============================] - 0s 49us/step - loss: 0.1611 - acc: 0.9534
Epoch 25/50

 32/879 [>.............................] - ETA: 0s - loss: 0.0796 - acc: 1.0000
879/879 [==============================] - 0s 49us/step - loss: 0.1506 - acc: 0.9602
Epoch 26/50

 32/879 [>.............................] - ETA: 0s - loss: 0.1317 - acc: 0.9688
879/879 [==============================] - 0s 49us/step - loss: 0.1412 - acc: 0.9670
Epoch 27/50

 32/879 [>.............................] - ETA: 0s - loss: 0.0937 - acc: 0.9688
879/879 [==============================] - 0s 49us/step - loss: 0.1341 - acc: 0.9625
Epoch 28/50

 32/879 [>.............................] - ETA: 0s - loss: 0.2441 - acc: 0.9375
879/879 [==============================] - 0s 55us/step - loss: 0.1293 - acc: 0.9693
Epoch 29/50

 32/879 [>.............................] - ETA: 0s - loss: 0.1447 - acc: 0.9688
800/879 [==========================>...] - ETA: 0s - loss: 0.1177 - acc: 0.9788
879/879 [==============================] - 0s 70us/step - loss: 0.1202 - acc: 0.9761
Epoch 30/50

 32/879 [>.............................] - ETA: 0s - loss: 0.1185 - acc: 0.9688
640/879 [====================>.........] - ETA: 0s - loss: 0.1097 - acc: 0.9734
879/879 [==============================] - 0s 90us/step - loss: 0.1146 - acc: 0.9738
Epoch 31/50

 32/879 [>.............................] - ETA: 0s - loss: 0.0561 - acc: 1.0000
736/879 [========================>.....] - ETA: 0s - loss: 0.0943 - acc: 0.9810
879/879 [==============================] - 0s 73us/step - loss: 0.1094 - acc: 0.9750
Epoch 32/50

 32/879 [>.............................] - ETA: 0s - loss: 0.0968 - acc: 0.9688
672/879 [=====================>........] - ETA: 0s - loss: 0.1087 - acc: 0.9762
879/879 [==============================] - 0s 82us/step - loss: 0.1044 - acc: 0.9772
Epoch 33/50

 32/879 [>.............................] - ETA: 0s - loss: 0.0569 - acc: 1.0000
879/879 [==============================] - 0s 56us/step - loss: 0.0977 - acc: 0.9795
Epoch 34/50

 32/879 [>.............................] - ETA: 0s - loss: 0.0410 - acc: 1.0000
879/879 [==============================] - 0s 51us/step - loss: 0.0936 - acc: 0.9807
Epoch 35/50

 32/879 [>.............................] - ETA: 0s - loss: 0.0779 - acc: 1.0000
768/879 [=========================>....] - ETA: 0s - loss: 0.0871 - acc: 0.9857
879/879 [==============================] - 0s 70us/step - loss: 0.0883 - acc: 0.9818
Epoch 36/50

 32/879 [>.............................] - ETA: 0s - loss: 0.1155 - acc: 0.9688
879/879 [==============================] - 0s 61us/step - loss: 0.0848 - acc: 0.9841
Epoch 37/50

 32/879 [>.............................] - ETA: 0s - loss: 0.0335 - acc: 1.0000
879/879 [==============================] - 0s 51us/step - loss: 0.0809 - acc: 0.9841
Epoch 38/50

 32/879 [>.............................] - ETA: 0s - loss: 0.0679 - acc: 1.0000
879/879 [==============================] - 0s 57us/step - loss: 0.0770 - acc: 0.9875
Epoch 39/50

 32/879 [>.............................] - ETA: 0s - loss: 0.0538 - acc: 1.0000
879/879 [==============================] - 0s 52us/step - loss: 0.0746 - acc: 0.9875
Epoch 40/50

 32/879 [>.............................] - ETA: 0s - loss: 0.1255 - acc: 0.9688
879/879 [==============================] - 0s 52us/step - loss: 0.0724 - acc: 0.9852
Epoch 41/50

 32/879 [>.............................] - ETA: 0s - loss: 0.0375 - acc: 1.0000
879/879 [==============================] - 0s 55us/step - loss: 0.0694 - acc: 0.9886
Epoch 42/50

 32/879 [>.............................] - ETA: 0s - loss: 0.1281 - acc: 0.9375
768/879 [=========================>....] - ETA: 0s - loss: 0.0711 - acc: 0.9870
879/879 [==============================] - 0s 70us/step - loss: 0.0665 - acc: 0.9886
Epoch 43/50

 32/879 [>.............................] - ETA: 0s - loss: 0.0616 - acc: 1.0000
879/879 [==============================] - 0s 53us/step - loss: 0.0639 - acc: 0.9863
Epoch 44/50

 32/879 [>.............................] - ETA: 0s - loss: 0.0470 - acc: 1.0000
879/879 [==============================] - 0s 52us/step - loss: 0.0602 - acc: 0.9909
Epoch 45/50

 32/879 [>.............................] - ETA: 0s - loss: 0.0838 - acc: 0.9688
879/879 [==============================] - 0s 52us/step - loss: 0.0591 - acc: 0.9898
Epoch 46/50

 32/879 [>.............................] - ETA: 0s - loss: 0.0662 - acc: 0.9688
879/879 [==============================] - 0s 51us/step - loss: 0.0555 - acc: 0.9898
Epoch 47/50

 32/879 [>.............................] - ETA: 0s - loss: 0.0589 - acc: 1.0000
879/879 [==============================] - 0s 51us/step - loss: 0.0538 - acc: 0.9920
Epoch 48/50

 32/879 [>.............................] - ETA: 0s - loss: 0.0286 - acc: 1.0000
879/879 [==============================] - 0s 52us/step - loss: 0.0522 - acc: 0.9920
Epoch 49/50

 32/879 [>.............................] - ETA: 0s - loss: 0.0277 - acc: 1.0000
879/879 [==============================] - 0s 51us/step - loss: 0.0500 - acc: 0.9920
Epoch 50/50

 32/879 [>.............................] - ETA: 0s - loss: 0.0373 - acc: 1.0000
879/879 [==============================] - 0s 52us/step - loss: 0.0482 - acc: 0.9932

 32/879 [>.............................] - ETA: 0s
879/879 [==============================] - 0s 23us/step

 32/540 [>.............................] - ETA: 0s
540/540 [==============================] - 0s 24us/step
Epoch 1/50

  32/1255 [..............................] - ETA: 0s - loss: 13.4142 - acc: 0.0625
 960/1255 [=====================>........] - ETA: 0s - loss: 6.9357 - acc: 0.1990 
1255/1255 [==============================] - 0s 56us/step - loss: 5.8900 - acc: 0.2295
Epoch 2/50

  32/1255 [..............................] - ETA: 0s - loss: 1.6601 - acc: 0.3438
1056/1255 [========================>.....] - ETA: 0s - loss: 1.6482 - acc: 0.4650
1255/1255 [==============================] - 0s 51us/step - loss: 1.6306 - acc: 0.4701
Epoch 3/50

  32/1255 [..............................] - ETA: 0s - loss: 1.4022 - acc: 0.5938
1056/1255 [========================>.....] - ETA: 0s - loss: 1.2927 - acc: 0.5938
1255/1255 [==============================] - 0s 50us/step - loss: 1.2680 - acc: 0.6008
Epoch 4/50

  32/1255 [..............................] - ETA: 0s - loss: 0.8448 - acc: 0.7812
1088/1255 [=========================>....] - ETA: 0s - loss: 1.0352 - acc: 0.6774
1255/1255 [==============================] - 0s 50us/step - loss: 1.0442 - acc: 0.6749
Epoch 5/50

  32/1255 [..............................] - ETA: 0s - loss: 1.0665 - acc: 0.6875
1056/1255 [========================>.....] - ETA: 0s - loss: 0.8393 - acc: 0.7434
1255/1255 [==============================] - 0s 50us/step - loss: 0.8254 - acc: 0.7490
Epoch 6/50

  32/1255 [..............................] - ETA: 0s - loss: 0.7387 - acc: 0.8125
1088/1255 [=========================>....] - ETA: 0s - loss: 0.6436 - acc: 0.8006
1255/1255 [==============================] - 0s 49us/step - loss: 0.6314 - acc: 0.8032
Epoch 7/50

  32/1255 [..............................] - ETA: 0s - loss: 0.2428 - acc: 1.0000
1056/1255 [========================>.....] - ETA: 0s - loss: 0.4905 - acc: 0.8362
1255/1255 [==============================] - 0s 50us/step - loss: 0.4858 - acc: 0.8390
Epoch 8/50

  32/1255 [..............................] - ETA: 0s - loss: 0.3844 - acc: 0.8438
1056/1255 [========================>.....] - ETA: 0s - loss: 0.3849 - acc: 0.8636
1255/1255 [==============================] - 0s 50us/step - loss: 0.3796 - acc: 0.8661
Epoch 9/50

  32/1255 [..............................] - ETA: 0s - loss: 0.4552 - acc: 0.7812
1024/1255 [=======================>......] - ETA: 0s - loss: 0.3154 - acc: 0.8916
1255/1255 [==============================] - 0s 52us/step - loss: 0.3161 - acc: 0.8916
Epoch 10/50

  32/1255 [..............................] - ETA: 0s - loss: 0.1809 - acc: 0.9688
1024/1255 [=======================>......] - ETA: 0s - loss: 0.2775 - acc: 0.9189
1255/1255 [==============================] - 0s 52us/step - loss: 0.2734 - acc: 0.9163
Epoch 11/50

  32/1255 [..............................] - ETA: 0s - loss: 0.2678 - acc: 0.9062
 960/1255 [=====================>........] - ETA: 0s - loss: 0.2467 - acc: 0.9177
1255/1255 [==============================] - 0s 57us/step - loss: 0.2333 - acc: 0.9235
Epoch 12/50

  32/1255 [..............................] - ETA: 0s - loss: 0.3906 - acc: 0.8750
 864/1255 [===================>..........] - ETA: 0s - loss: 0.2224 - acc: 0.9340
1255/1255 [==============================] - 0s 61us/step - loss: 0.2102 - acc: 0.9347
Epoch 13/50

  32/1255 [..............................] - ETA: 0s - loss: 0.2291 - acc: 0.9375
 864/1255 [===================>..........] - ETA: 0s - loss: 0.1887 - acc: 0.9421
1255/1255 [==============================] - 0s 64us/step - loss: 0.1856 - acc: 0.9386
Epoch 14/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0913 - acc: 1.0000
 800/1255 [==================>...........] - ETA: 0s - loss: 0.1506 - acc: 0.9537
1255/1255 [==============================] - 0s 64us/step - loss: 0.1691 - acc: 0.9490
Epoch 15/50

  32/1255 [..............................] - ETA: 0s - loss: 0.2750 - acc: 0.8438
 960/1255 [=====================>........] - ETA: 0s - loss: 0.1529 - acc: 0.9542
1255/1255 [==============================] - 0s 60us/step - loss: 0.1532 - acc: 0.9522
Epoch 16/50

  32/1255 [..............................] - ETA: 0s - loss: 0.1643 - acc: 0.9062
 736/1255 [================>.............] - ETA: 0s - loss: 0.1398 - acc: 0.9606
1255/1255 [==============================] - 0s 75us/step - loss: 0.1406 - acc: 0.9570
Epoch 17/50

  32/1255 [..............................] - ETA: 0s - loss: 0.2904 - acc: 0.9375
 768/1255 [=================>............] - ETA: 0s - loss: 0.1397 - acc: 0.9635
1255/1255 [==============================] - 0s 69us/step - loss: 0.1326 - acc: 0.9665
Epoch 18/50

  32/1255 [..............................] - ETA: 0s - loss: 0.1210 - acc: 0.9688
 640/1255 [==============>...............] - ETA: 0s - loss: 0.1070 - acc: 0.9703
1255/1255 [==============================] - 0s 74us/step - loss: 0.1211 - acc: 0.9641
Epoch 19/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0765 - acc: 1.0000
 928/1255 [=====================>........] - ETA: 0s - loss: 0.1104 - acc: 0.9720
1255/1255 [==============================] - 0s 60us/step - loss: 0.1135 - acc: 0.9713
Epoch 20/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0666 - acc: 0.9688
 896/1255 [====================>.........] - ETA: 0s - loss: 0.1098 - acc: 0.9754
1255/1255 [==============================] - 0s 60us/step - loss: 0.1054 - acc: 0.9737
Epoch 21/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0874 - acc: 1.0000
 896/1255 [====================>.........] - ETA: 0s - loss: 0.1045 - acc: 0.9665
1255/1255 [==============================] - 0s 59us/step - loss: 0.1013 - acc: 0.9689
Epoch 22/50

  32/1255 [..............................] - ETA: 0s - loss: 0.1060 - acc: 0.9688
1024/1255 [=======================>......] - ETA: 0s - loss: 0.1001 - acc: 0.9717
1255/1255 [==============================] - 0s 55us/step - loss: 0.0932 - acc: 0.9761
Epoch 23/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0654 - acc: 1.0000
 896/1255 [====================>.........] - ETA: 0s - loss: 0.0864 - acc: 0.9777
1255/1255 [==============================] - 0s 57us/step - loss: 0.0866 - acc: 0.9777
Epoch 24/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0512 - acc: 1.0000
 832/1255 [==================>...........] - ETA: 0s - loss: 0.0842 - acc: 0.9832
1255/1255 [==============================] - 0s 63us/step - loss: 0.0840 - acc: 0.9825
Epoch 25/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0860 - acc: 0.9688
1024/1255 [=======================>......] - ETA: 0s - loss: 0.0751 - acc: 0.9863
1255/1255 [==============================] - 0s 53us/step - loss: 0.0784 - acc: 0.9833
Epoch 26/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0621 - acc: 1.0000
1056/1255 [========================>.....] - ETA: 0s - loss: 0.0756 - acc: 0.9848
1255/1255 [==============================] - 0s 54us/step - loss: 0.0770 - acc: 0.9833
Epoch 27/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0403 - acc: 1.0000
 864/1255 [===================>..........] - ETA: 0s - loss: 0.0749 - acc: 0.9838
1255/1255 [==============================] - 0s 64us/step - loss: 0.0718 - acc: 0.9849
Epoch 28/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0358 - acc: 1.0000
 864/1255 [===================>..........] - ETA: 0s - loss: 0.0682 - acc: 0.9861
1255/1255 [==============================] - 0s 63us/step - loss: 0.0676 - acc: 0.9857
Epoch 29/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0181 - acc: 1.0000
 672/1255 [===============>..............] - ETA: 0s - loss: 0.0600 - acc: 0.9821
1255/1255 [==============================] - 0s 79us/step - loss: 0.0661 - acc: 0.9841
Epoch 30/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0417 - acc: 1.0000
 672/1255 [===============>..............] - ETA: 0s - loss: 0.0631 - acc: 0.9836
1255/1255 [==============================] - 0s 79us/step - loss: 0.0615 - acc: 0.9857
Epoch 31/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0331 - acc: 1.0000
 800/1255 [==================>...........] - ETA: 0s - loss: 0.0504 - acc: 0.9938
1255/1255 [==============================] - 0s 70us/step - loss: 0.0591 - acc: 0.9912
Epoch 32/50

  32/1255 [..............................] - ETA: 0s - loss: 0.1306 - acc: 0.9375
 704/1255 [===============>..............] - ETA: 0s - loss: 0.0571 - acc: 0.9872
1255/1255 [==============================] - 0s 75us/step - loss: 0.0562 - acc: 0.9880
Epoch 33/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0310 - acc: 1.0000
 704/1255 [===============>..............] - ETA: 0s - loss: 0.0542 - acc: 0.9915
1255/1255 [==============================] - 0s 76us/step - loss: 0.0548 - acc: 0.9912
Epoch 34/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0554 - acc: 1.0000
 640/1255 [==============>...............] - ETA: 0s - loss: 0.0554 - acc: 0.9938
1216/1255 [============================>.] - ETA: 0s - loss: 0.0521 - acc: 0.9918
1255/1255 [==============================] - 0s 88us/step - loss: 0.0528 - acc: 0.9920
Epoch 35/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0192 - acc: 1.0000
 672/1255 [===============>..............] - ETA: 0s - loss: 0.0536 - acc: 0.9896
1255/1255 [==============================] - 0s 76us/step - loss: 0.0502 - acc: 0.9912
Epoch 36/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0437 - acc: 1.0000
 768/1255 [=================>............] - ETA: 0s - loss: 0.0508 - acc: 0.9922
1255/1255 [==============================] - 0s 69us/step - loss: 0.0484 - acc: 0.9936
Epoch 37/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0618 - acc: 0.9688
 832/1255 [==================>...........] - ETA: 0s - loss: 0.0435 - acc: 0.9940
1255/1255 [==============================] - 0s 76us/step - loss: 0.0468 - acc: 0.9928
Epoch 38/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0457 - acc: 1.0000
 800/1255 [==================>...........] - ETA: 0s - loss: 0.0422 - acc: 0.9950
1255/1255 [==============================] - 0s 69us/step - loss: 0.0457 - acc: 0.9944
Epoch 39/50

  32/1255 [..............................] - ETA: 0s - loss: 0.1756 - acc: 0.9688
 704/1255 [===============>..............] - ETA: 0s - loss: 0.0536 - acc: 0.9929
1255/1255 [==============================] - 0s 72us/step - loss: 0.0435 - acc: 0.9960
Epoch 40/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0506 - acc: 0.9688
 768/1255 [=================>............] - ETA: 0s - loss: 0.0441 - acc: 0.9948
1255/1255 [==============================] - 0s 70us/step - loss: 0.0433 - acc: 0.9944
Epoch 41/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0585 - acc: 1.0000
 736/1255 [================>.............] - ETA: 0s - loss: 0.0423 - acc: 0.9932
1255/1255 [==============================] - 0s 76us/step - loss: 0.0405 - acc: 0.9928
Epoch 42/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0112 - acc: 1.0000
 800/1255 [==================>...........] - ETA: 0s - loss: 0.0392 - acc: 0.9938
1255/1255 [==============================] - 0s 70us/step - loss: 0.0386 - acc: 0.9960
Epoch 43/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0641 - acc: 0.9688
 832/1255 [==================>...........] - ETA: 0s - loss: 0.0331 - acc: 0.9952
1255/1255 [==============================] - 0s 65us/step - loss: 0.0375 - acc: 0.9960
Epoch 44/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0588 - acc: 0.9688
 864/1255 [===================>..........] - ETA: 0s - loss: 0.0370 - acc: 0.9977
1255/1255 [==============================] - 0s 63us/step - loss: 0.0360 - acc: 0.9952
Epoch 45/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0220 - acc: 1.0000
 800/1255 [==================>...........] - ETA: 0s - loss: 0.0280 - acc: 0.9975
1255/1255 [==============================] - 0s 66us/step - loss: 0.0350 - acc: 0.9968
Epoch 46/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0286 - acc: 1.0000
 864/1255 [===================>..........] - ETA: 0s - loss: 0.0298 - acc: 0.9977
1255/1255 [==============================] - 0s 58us/step - loss: 0.0336 - acc: 0.9968
Epoch 47/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0243 - acc: 1.0000
1056/1255 [========================>.....] - ETA: 0s - loss: 0.0307 - acc: 0.9981
1255/1255 [==============================] - 0s 51us/step - loss: 0.0328 - acc: 0.9984
Epoch 48/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0173 - acc: 1.0000
1024/1255 [=======================>......] - ETA: 0s - loss: 0.0330 - acc: 0.9980
1255/1255 [==============================] - 0s 52us/step - loss: 0.0313 - acc: 0.9984
Epoch 49/50

  32/1255 [..............................] - ETA: 0s - loss: 0.0063 - acc: 1.0000
1088/1255 [=========================>....] - ETA: 0s - loss: 0.0257 - acc: 0.9991
1255/1255 [==============================] - 0s 50us/step - loss: 0.0308 - acc: 0.9984
Epoch 50/50

  32/1255 [..............................] - ETA: 0s - loss: 0.1310 - acc: 0.9688
1056/1255 [========================>.....] - ETA: 0s - loss: 0.0310 - acc: 0.9981
1255/1255 [==============================] - 0s 51us/step - loss: 0.0299 - acc: 0.9984

  32/1255 [..............................] - ETA: 0s
1255/1255 [==============================] - 0s 21us/step

 32/540 [>.............................] - ETA: 0s
540/540 [==============================] - 0s 22us/step
'''